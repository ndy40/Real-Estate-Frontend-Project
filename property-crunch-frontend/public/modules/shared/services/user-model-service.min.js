define(["../module.min","cookies"],function(t){"use strict";t.service("UserModel",["AuthService","$cookieStore","$http","FAPI","FavService",function(t,e,o,i,s){var n=function(){this.isLoggedIn=e.get("isLoggedIn"),this.fullname=e.get("fullname"),this.userId=e.get("userId"),this.favourites=e.get("favourites"),this.favCount=e.get("favCount")};return n.prototype.createSession=function(t){t.hasOwnProperty("first_name")&&(this.isLoggedIn=!0,this.fullname=t.first_name+" "+t.last_name,this.userId=t.id,this.favourites=t.favourites,this.getFavCount(),this.saveSession(t))},n.prototype.saveSession=function(t){e.put("isLoggedIn",!0),e.put("fullname",t.first_name+" "+t.last_name),e.put("userId",t.id),e.put("favourites",t.favourites),e.put("favCount",this.favCount)},n.prototype.deleteSession=function(){e.remove("isLoggedIn"),e.remove("fullname"),e.remove("userId"),e.remove("favourites"),e.remove("favCount")},n.prototype.logout=function(){this.isLoggedIn=null,this.fullname=null,this.deleteSession(),t.logout()},n.prototype.isFav=function(t){return this.favourites.match(new RegExp("(?:^|,)"+t+"(?:,|$)"))?!0:!1},n.prototype.updateFavCookies=function(){e.remove("favourites"),e.remove("favCount"),e.put("favourites",this.favourites),e.put("favCount",this.favCount)},n.prototype.addToFav=function(t){return o.get(i.addToFav+this.userId+"/"+t)},n.prototype.addToFavFE=function(t){this.isFav(t)||(this.favourites+=","+t,this.incFavCount(),this.updateFavCookies(),s.clearCache())},n.prototype.removeFav=function(t){return o.get(i.removeFav+this.userId+"/"+t)},n.prototype.removeFavFE=function(t){for(var e=this.favourites.split(","),o=0;o<e.length;o++)e[o]===t&&e.splice(o,1);this.favourites=e.toString(),this.decFavCount(),this.updateFavCookies(),s.clearCache()},n.prototype.getFavCount=function(){var t=this.favourites.split(",").length-1;return this.favCount=0>t?0:t,this.favCount},n.prototype.incFavCount=function(){return this.favCount++},n.prototype.decFavCount=function(){return this.favCount--},new n}])});